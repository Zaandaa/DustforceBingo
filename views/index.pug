extends layout

block js
	script= "const error = \'" + error + "';"
	script!= "const invalidsets = " + JSON.stringify(invalidsets) + ";"
	script(src="/bingo/js/index.js")

block content
	div.floater
		div.alert.alert-danger(role="alert", style="display:none;")
			div.alert-text
			button.close(type="button", aria-label="Close")
				span(aria-hidden="true") &times;

	div.row
		div.col-xl-4
			div
				p Challenge yourself and race others with Dustforce bingo! Goals are randomly generated from unique options creating many new ways to play. If you're looking to race, join the #[a(href='https://discordapp.com/invite/0SkxtG7ddS6n2BCW') Dustforce Discord] and ask in the #races channel.

			div
				h4.impact How to play
				ul
					li Goals automatically complete using replays
					li #[a(href='http://dustmod.com/') Dustmod] is recommended (required for Unload, Low% and Randomizer)
					li Access new save file options in the Dustmod menu via Tools > Save > Reset Save

			include how.pug

			div
				h4.impact Randomizer
				p Bingo and Lockout Race can be combined with #[a(href='https://dustkid.com/randomizer/') Randomizer] only with the nexusdx template. If using Atlas levels, only these goal options can be used: Beat, SS, Keys, Multi, Characters. If characters are on, impossible bingo seeds can be created.

		div.col-xl-8.noselect
			div.row(style="position: absolute; top: -50px; width: 100%")
				div#type_row.col-xl-6
					div(style="width: 60%; margin: auto; margin-bottom: 15px")
						select#gametype.session.form-control
							option(value="bingo" selected) Bingo
							option(value="64") Lockout Race

			div.row
				div.col-xl-6(style="min-height: 466px")
					div#bingo_options
						h4 Bingo Options

						div.form-group
							div Size:
							select#size.session.form-control
								option(value="3") 3 by 3
								option(value="4" selected) 4 by 4
								option(value="5") 5 by 5
						div.form-group
							div Difficulty:
							select#difficulty_raw.session.form-control
								option(value="Easy") Easy
								option(value="Normal" selected) Normal
								option(value="Hard") Hard
								option(value="Very Hard") Very Hard
						div.form-group
							div Length:
							select#length_raw.session.form-control
								option(value="Fast") Fast
								option(value="Normal" selected) Normal
								option(value="Long") Long
								option(value="Full Game") Full Game

						div.row 
							div.col-xl-6.first
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#newgame.session(type="checkbox" checked)
										<img id="check_newgame" class="checkbox_img icon" src="/bingo/img/ready_true.png" />
										p New Game
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="New Game requires levels to be unlocked with keys")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#teams.session(type="checkbox")
										<img id="check_teams" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Team colors
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Players with the same color are on a team")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#hiddenlocal.session(type="checkbox")
										<img id="check_hiddenlocal" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Hidden share vision
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="When a goal is revealed, it is revealed to all players")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#antibingo.session(type="checkbox")
										<img id="check_antibingo" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Antibingo
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Assign bingos to your opponent")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#rando.session(type="checkbox")
										<img id="check_rando" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Randomizer
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Include a Randomizer link")
											div(style="position: relative; top: -1px") ?

							div.col-xl-6.second
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#lockout.session(type="checkbox")
										<img id="check_lockout" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Lockout
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Each goal can only be achieved by one person")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#hidden.session(type="checkbox")
										<img id="check_hidden" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Hidden goals
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Start with only one goal visible; reveal neighbors by getting goals")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#hiddensame.session(type="checkbox")
										<img id="check_hiddensame" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Hidden share start
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Everyone shares the same starting visible goal")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#plugins.session(type="checkbox")
										<img id="check_plugins" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Allow mods
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Players may use any mods and plugins")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									input#rando_link.form-inline(placeholder="Download/share link")

						div.form-group.row
							div.col-12
								div First to:
							div.col-sm-5
								select#bingo_count.session.form-control
									each val, i in Array(25)
										option(value=i+1 class='option' + (i+1))= i+1
							div.col-sm-7
								select#bingo_count_type.session.form-control
									option(value="bingo") Bingos
									option(value="goal") Goals

					div#64_options(style="display: none")
						h4 Lockout Race Options

						div.form-group
							div Hub:
							select#hub.session.form-control
								option(value="All" selected) All
								option(value="Forest") Forest
								option(value="Mansion") Mansion
								option(value="City") City
								option(value="Laboratory") Laboratory
								option(value="Random") Random

						div.form-group
							div Win condition:
							select#win_type.session.form-control
								option(value="totalarea" selected) Total area
								option(value="area") Biggest connected area
								option(value="goal") First to goal count

						div#required_goals.form-group(style="display: none")
							div Required goals:
							select#goal_count.session.form-control
								each val, i in Array(33)
									option(value=i+1 class='option' + (i+1))= i+1

						div.row
							div.col-xl-6.first
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#newgame64.session(type="checkbox" checked)
										<img id="check_newgame64" class="checkbox_img icon" src="/bingo/img/ready_true.png" />
										p New Game
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="New Game requires levels to be unlocked with keys")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#ss64.session(type="checkbox")
										<img id="check_ss64" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Require SS
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#hidden64local.session(type="checkbox")
										<img id="check_hidden64local" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Hidden share vision
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="When a goal is revealed, it is revealed to all players")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#captureblank.session(type="checkbox")
										<img id="check_captureblank" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Capture empty
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Unclaimed goals can be captured")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#teams64.session(type="checkbox")
										<img id="check_teams64" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Team colors
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Players with the same color are on a team")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#rando64.session(type="checkbox")
										<img id="check_rando64" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Randomizer
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Include a Randomizer link")
											div(style="position: relative; top: -1px") ?

							div.col-xl-6.second
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#shuffle.session(type="checkbox")
										<img id="check_shuffle" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Shuffle levels
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#hidden64.session(type="checkbox")
										<img id="check_hidden64" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Hidden goals
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Start with all level goals invisible; reveal neighbors by getting goals")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#hidden64same.session(type="checkbox")
										<img id="check_hidden64same" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Hidden share start
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Everyone shares the same starting visible goal")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#captureother.session(type="checkbox")
										<img id="check_captureother" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Capture enemy
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Enemy-owned goals can be captured")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									label(style="min-width: 100px")
										input#plugins64.session(type="checkbox")
										<img id="check_plugins64" class="checkbox_img icon" src="/bingo/img/ready_false.png" />
										p Allow mods
									div.tt_question
										div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title="Players may use any mods and plugins")
											div(style="position: relative; top: -1px") ?
								div.form-group.checkbox.margin_zero
									input#rando_link64.form-inline(placeholder="Download/share link")

				div.col-xl-6
					div#goal_options
						h4 Goal Options
						
						div#goals_advanced_div
							div.row 
								- var optionKeys = Object.keys(options);
								- var half = Math.ceil(optionKeys.length / 2);    
								- var first = optionKeys.splice(0, half);
								div.col-xl-6.first
									each option, i in first 
										div.checkbox
											label
												- var checkImg = options[option].init_state ? "/bingo/img/ready_true.png" : "/bingo/img/ready_false.png";
												input.session(id=option type="checkbox" checked=options[option].init_state)
												img.checkbox_img.icon(id="check_" + option src=checkImg)
												img(src=options[option].icon class=options[option].icon_type)
												p= options[option].clean_name
											if options[option].tooltip
												div.tt_question
													div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title=options[option].tooltip)
														div(style="position: relative; top: -1px") ?
												
								div.col-xl-6.second
									each option, i in optionKeys 
										div.checkbox
											label
												- var checkImg = options[option].init_state ? "/bingo/img/ready_true.png" : "/bingo/img/ready_false.png";
												input.session(id=option type="checkbox" checked=options[option].init_state)
												img.checkbox_img.icon(id="check_" + option src=checkImg)
												img.icon(src=options[option].icon)
												p= options[option].clean_name
											if options[option].tooltip
												div.tt_question
													div.color-circle-tooltip(data-toggle="tooltip" data-placement="top" title=options[option].tooltip)
														div(style="position: relative; top: -1px") ?

			div.row
				div.col-xl-6
					button#generate.btn.btn-lg.btn-block Generate session
	div.row
		div#session_container
			div.left-click(style="display:none;") <
			div.right-click(style="display:none;") >